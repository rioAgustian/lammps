units metal
boundary p p p
atom_style full
neighbor 1.0 bin
neigh_modify delay 1
pair_style lj/cut/tip4p/long OW HW OW-HW HW-OW-HW 0.1546 10
kspace_style pppm/tip4p 1.0e-5
bond_style harmonic
angle_style harmonic

read_data cracking.data
molecule h2omol H2O.mol
create_atoms 0 random 3 3245 NULL mol h2omol 4585 overlap 2.0 maxtry 50

group SiO type Si O
group H2O type OW HW

pair_coeff * * 0 0
pair_coeff Si OW 0.0057 4.42
pair_coeff O OW 0.0043 3.12
pair_coeff OW OW 0.008 3.1589
pair_coeff HW HW 0.0 0.0
bond_coeff OW-HW 0 0.9572
angle_coeff HW-OW-HW 0 104.52

variable oxygen atom type==label2type(atom,OW)
group oxygen dynamic all var oxygen
variable nO equal count(oxygen)

fix shak H2O shake 1.0e-5 200 0 b OW-HW a HW-OW-HW mol h2omol

compute  ctH2O H2O temp
compute_modify thermo_temp dynamic/dof yes
compute_modify ctH2O dynamic/dof yes
fix mynvt H2O nvt temp 300 300 0.1
fix_modify mynvt temp ctH2O
timestep 0.001

variable tfac equal 5.0/3.0
fix fgcmc H2O gcmc 100 100 0 0 65899 300 -0.5 0.1 mol h2omol tfac_insert ${tfac} shake shak full_energy pressure 100

thermo 250
thermo_style custom step temp etotal v_nO f_fgcmc[3] f_fgcmc[4] f_fgcmc[5] f_fgcmc[6] press

variable mystep equal step
variable mytemp equal temp
variable myetotal equal etotal
variable myvol equal vol
variable mydensity equal density
variable mypress equal press

# Use fix print to output
fix print_data all print 100 "${mystep} ${mytemp} ${myetotal} ${myvol} ${mydensity} ${mypress} ${nO}" file number_data.txt screen no title "step temp tot_eng vol density press nO"

dump mydump all atom 250 dump_gcmc.lammpstrj

run 25000